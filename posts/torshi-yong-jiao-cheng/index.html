<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Tor使用教程</title>
  <meta name=author content="cylind">
  <meta name=description content="&amp;lt;p&amp;gt;Tor是实现匿名通信的自由软件。其名源于“The Onion Router”（洋葱路由器）的英语缩写。用户可透过Tor接达由全球志愿者免费提供，包含7000+个中继的覆盖网络，从而达至隐藏用户真实地址、避免网络监控及流量分析的目的。Tor用户的互联网活动（包括浏览在线网站、帖子以及即时消息等通信形式）相对较难追踪。Tor的设计原意在于保障用户的个人隐私，以及不受监控地进行秘密通信的自由和能力…" />
  <meta name="robots" content="max-image-preview:large" />
  <link rel=canonical href="/posts/torshi-yong-jiao-cheng/">
  <meta property="og:type" content="article">
  <meta property="og:url" content="/posts/torshi-yong-jiao-cheng/">
  <meta property="og:site_name" content="cylind blog">
  <meta property="og:title" content="Tor使用教程">
  <meta property="og:description" content="&amp;lt;p&amp;gt;Tor是实现匿名通信的自由软件。其名源于“The Onion Router”（洋葱路由器）的英语缩写。用户可透过Tor接达由全球志愿者免费提供，包含7000+个中继的覆盖网络，从而达至隐藏用户真实地址、避免网络监控及流量分析的目的。Tor用户的互联网活动（包括浏览在线网站、帖子以及即时消息等通信形式）相对较难追踪。Tor的设计原意在于保障用户的个人隐私，以及不受监控地进行秘密通信的自由和能力…">
  <meta name=twitter:card content="summary">
  <meta name=twitter:title content="Tor使用教程">
  <meta name=twitter:description content="&amp;lt;p&amp;gt;Tor是实现匿名通信的自由软件。其名源于“The Onion Router”（洋葱路由器）的英语缩写。用户可透过Tor接达由全球志愿者免费提供，包含7000+个中继的覆盖网络，从而达至隐藏用户真实地址、避免网络监控及流量分析的目的。Tor用户的互联网活动（包括浏览在线网站、帖子以及即时消息等通信形式）相对较难追踪。Tor的设计原意在于保障用户的个人隐私，以及不受监控地进行秘密通信的自由和能力…">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <link rel="icon" sizes="16x16" href="/favicon.ico" />
  <link rel=alternate type=application/rss+xml href="/index.xml" title=cylind blog/>
  <link rel="stylesheet" href="/main.css"/>
</head>

<body>
  <header>
    <a class="header__verification" href="">cylind blog</a>
    <p class="header__official">Official</p>
    <nav>
      <ul>
        <li>
          <a href="/">Home</a>
          
        </li>
        <li>
          <a href="/posts/">Posts</a>
          
        </li>
        <li>
          <a href="/about/">About</a>
          
        </li>
      </ul>
    </nav>
  </header>
  <main>
    <article>
      <header>
        <h1>Tor使用教程</h1>
        <span>
          <br><time datetime="2020-05-27T20:16:46">May 27, 2020</time>
        </span>
      </header><p>Tor是实现匿名通信的自由软件。其名源于“The Onion Router”（洋葱路由器）的英语缩写。用户可透过Tor接达由全球志愿者免费提供，包含7000+个中继的覆盖网络，从而达至隐藏用户真实地址、避免网络监控及流量分析的目的。Tor用户的互联网活动（包括浏览在线网站、帖子以及即时消息等通信形式）相对较难追踪。Tor的设计原意在于保障用户的个人隐私，以及不受监控地进行秘密通信的自由和能力。</p>
<span id="continue-reading"></span>
<p>使用Tor一般有两种方式，最常见的一种，是直接使用集成了Firefox浏览器的Tor Broswer，这种方法简单高效，不需要额外配置，直接下载安装即可使用。另一种，则稍显复杂，直接使用裸Tor。使用裸Tor可以更方便地搭配其他软件使用，而且占用资源少，更适合追求简洁的玩家。</p>
<p>下面就是介绍Windows/Linux下如何配置这种裸Tor来匿名上网。</p>
<h2 id="windowsxia-shi-yong-tor">Windows下使用Tor</h2>
<h3 id="cong-tor-broswerzhong-ti-qu-tor">从Tor Broswer中提取Tor</h3>
<p>去到Tor官网下载Tor浏览器安装到任意目录，安装完成后把安装目录下的<code>Tor Browser\Browser\TorBrowser\Tor</code>文件夹复制一份出来，在这个<code>Tor</code>文件夹下新建一个<code>Data</code>文件夹,再把<code>\Tor Browser\Browser\TorBrowser\Data\Tor</code>下的<code>geoip</code>、<code>geoip6</code>这两个文件复制到<code>Data</code>文件夹中，这样就得到了裸Tor包含的所有文件了。</p>
<p>接下来就是编写Tor的配置文件了，在<code>Tor</code>文件下创建<code>torrc</code>文件，用编辑器打开，输入配置信息，这里给出把tor作为前置代理的配置和利用meek插件(新版的Tor中，所有插件都包含在obfs4proxy.exe中)直连tor的配置：</p>
<pre style="background-color:#ffffff;color:#323232;"><code><span># 把tor作为其他代理软件的前置代理
</span><span>DataDirectory ./Data
</span><span>GeoIPFile ./Data/geoip
</span><span>GeoIPv6File ./Data/geoip6
</span><span># 设置前置socks5代理
</span><span>Socks5Proxy 127.0.0.1:1080
</span><span># 排除有安全隐患的国家
</span><span>ExcludeNodes {cn},{hk},{mo},{kp},{ir},{sy},{pk},{cu},{vn},{ru}
</span><span>ExcludeExitNodes {cn},{hk},{mo},{sg},{th},{pk},{by},{ru},{ir},{vn},{ph},{my},{cu}
</span><span>StrictNodes 1
</span></code></pre>
<pre data-lang="ini" style="background-color:#ffffff;color:#323232;" class="language-ini "><code class="language-ini" data-lang="ini"><span style="font-style:italic;color:#969896;"># 利用meek插件直连tor的配置
</span><span>DataDirectory </span><span style="font-weight:bold;color:#a71d5d;">./</span><span>Data
</span><span>GeoIPFile </span><span style="font-weight:bold;color:#a71d5d;">./</span><span>Data</span><span style="font-weight:bold;color:#a71d5d;">/</span><span>geoip
</span><span>GeoIPv6File </span><span style="font-weight:bold;color:#a71d5d;">./</span><span>Data</span><span style="font-weight:bold;color:#a71d5d;">/</span><span>geoip6
</span><span style="font-style:italic;color:#969896;"># 使用meek网桥
</span><span>ClientTransportPlugin meek_lite exec </span><span style="font-weight:bold;color:#a71d5d;">./</span><span>PluggableTransports</span><span style="font-weight:bold;color:#a71d5d;">/</span><span>obfs4proxy</span><span style="font-weight:bold;color:#a71d5d;">.</span><span>exe
</span><span>UseBridges </span><span style="color:#0086b3;">1
</span><span>Bridge meek_lite </span><span style="color:#0086b3;">0.0.2.0:2</span><span> 97700DFE9F483596DDA6264C4D7DF7641E1E39CE url</span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#0086b3;">https://meek.azureedge.net</span><span style="font-weight:bold;color:#a71d5d;">/</span><span> front</span><span style="font-weight:bold;color:#a71d5d;">=</span><span>ajax</span><span style="font-weight:bold;color:#a71d5d;">.</span><span>aspnetcdn</span><span style="font-weight:bold;color:#a71d5d;">.</span><span>com
</span><span style="font-style:italic;color:#969896;"># 排除出口节点
</span><span style="font-weight:bold;color:#a71d5d;">ExcludeExitNodes </span><span>{cn}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{hk}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{mo}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{sg}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{th}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{pk}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{by}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{ru}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{ir}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{vn}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{ph}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{my}</span><span style="font-weight:bold;color:#a71d5d;">,</span><span>{cu}
</span><span>StrictNodes </span><span style="color:#0086b3;">1
</span></code></pre>
<h3 id="zhi-jie-xia-zai-windows-expert-bundle">直接下载Windows Expert Bundle</h3>
<p>除了下载Tor浏览器提取裸Tor的方法外，还可以在这里https://www.torproject.org/download/tor/直接下载<code>Windows Expert Bundle</code>，解压后即可得裸Tor，不过这里的裸Tor是真的裸，连meek插件（obfs4proxy.exe）都是没有的，那么它自然是不能直连的，只能作为其它代理软件的前置代理了，配置文件写法如上，不过注意<code>geoip</code>、<code>geoip6</code>文件路径，不能照搬上述配置信息了，自己在配置文件中改一下路径。</p>
<h3 id="zai-windowsxia-yun-xing-tor">在Windows下运行Tor</h3>
<p>通过上述两个步骤获得Tor后，即可开始运行Tor。运行Tor可以在Tor文件下调出命令行输入<code>tor -f torrc</code>,为了方便直接在<code>Tor</code>文件夹下创建一个名为<code>start.cmd</code>的脚本，脚本中填入<code>tor -f torrc</code>，以后启动Tor直接运行这个脚本就可以啦。</p>
<h2 id="linuxxia-shi-yong-tor">Linux下使用Tor</h2>
<p>Debian/Ubuntu下，可直接安装</p>
<pre data-lang="sh" style="background-color:#ffffff;color:#323232;" class="language-sh "><code class="language-sh" data-lang="sh"><span>sudo apt install tor -y
</span></code></pre>
<p>修改配置文件<code>/etc/tor/torrc</code>,在其末尾添加如下内容</p>
<pre style="background-color:#ffffff;color:#323232;"><code><span># 设置前置socks5代理
</span><span>Socks5Proxy 127.0.0.1:1080
</span><span># 排除有安全隐患的国家
</span><span>ExcludeNodes {cn},{hk},{mo},{kp},{ir},{sy},{pk},{cu},{vn},{ru}
</span><span>ExcludeExitNodes {cn},{hk},{mo},{sg},{th},{pk},{by},{ru},{ir},{vn},{ph},{my},{cu}
</span><span>StrictNodes 1
</span></code></pre>
<p>启动Tor并设置开机自启动</p>
<pre data-lang="sh" style="background-color:#ffffff;color:#323232;" class="language-sh "><code class="language-sh" data-lang="sh"><span>systemctl start tor
</span><span>systemctl enable tor
</span></code></pre>
<p>验证tor是否链接成功（安装tor的同时一般会默认附带安装了torsocks）</p>
<pre data-lang="bash" style="background-color:#ffffff;color:#323232;" class="language-bash "><code class="language-bash" data-lang="bash"><span>torsocks curl myip.ipip.net
</span></code></pre>
<p>如果返回tor节点ip或者被Cloudflare拦截返回一段验证html，则说明tor设置成功。</p>
<h2 id="torjin-jie-wan-fa">Tor进阶玩法</h2>
<h3 id="san-zhong-dai-li">三重代理</h3>
<p>直接使用Tor容易被ISP识别，因为Tor的流量特征太明显了，而加一层前置代理虽然可以解决这个问题，但是被访问的目标网站还是知道你在用Tor，而且有些目标网站对Tor不友好，这时候怎么办呢？我们可以用三重代理，这样一来，你的ISP不知道你在用Tor，你访问的目标网站也不知道你在用Tor。具体实现如下：</p>
<p>Web Browser --&gt; Proxy Client 1(1080) --&gt; Tor Client(9050) --&gt; Proxy Client 2(1081) --&gt; Proxy Server 2 --&gt; Tor Server --&gt; Proxy Server 1 --&gt; Internet</p>
<p>其中，Proxy Server 1为最后出口，即经由它直接访问目标网站，最为薄弱；Proxy Server 2作为连接国内到国外的通道，直接决定访问速度；而Tor Server作为中间层，对接Proxy Server 1的入口。那么，可以把网络上公开的免费的公共代理服务器作为Proxy Server 1，而自己的私人代理服务器作为Proxy Server 2，这样一来便可确保安全的同时保证访问速度。</p>
<p>值得注意的是，Proxy Client 2需要支持前置代理才行。</p>
<script src="https://giscus.app/client.js"
            data-repo="cylind&#x2F;cylind.github.io"
            data-repo-id="MDEwOlJlcG9zaXRvcnkzMDIyMjI4NjY="
            data-category="General"
            data-category-id="DIC_kwDOEgOOEs4CvjAr"
            data-mapping="title"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="preferred_color_scheme"
            data-lang="en"
            crossorigin="anonymous"
            async>
      </script></article>
  </main>
  <footer>
    <p>
      Powered by <a target="_blank" rel="noopener" href="https://www.getzola.org">zola 0.20.0</a>
      | Theme <a target=_blank rel=noopener href=https://github.com/inhzus/zola-futu>futu@main</a>
    </p>
  </footer>
  
</body>
</html>
